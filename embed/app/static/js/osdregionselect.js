window.osdRegionRectTool=function(a){function b(){f(!0),k.addHandler("canvas-drag",c),k.addHandler("canvas-release",d),a.onModeEnter&&a.onModeEnter()}function c(b){if(m){var c=k.viewport.pointFromPixel(b.position);h(l,c),a.onDraw&&a.onDraw()}else m=!0,l=k.viewport.pointFromPixel(b.position),g(l),a.onDrawStart&&a.onDrawStart()}function d(b){m=!1,osdImageRect=k.viewport.viewportToImageRectangle(i),canvasRect={x:parseInt(osdImageRect.x,10),y:parseInt(osdImageRect.y,10),width:parseInt(osdImageRect.width,10),height:parseInt(osdImageRect.height,10)},a.onDrawFinish&&a.onDrawFinish(canvasRect),k.removeOverlay(j)}function e(b){f(!1),k.removeHandler("canvas-drag",c),k.removeHandler("canvas-release",d),a.onModeExit&&a.onModeExit()}function f(a){a?(k.panHorizontal=!1,k.panVertical=!1):(k.panHorizontal=!0,k.panVertical=!0)}function g(a){var b=a.x,c=a.y,d=0,e=0;i=new OpenSeadragon.Rect(b,c,d,e),j=document.createElement("div"),j.className="osd-select-rectangle",k.addOverlay({element:j,location:i})}function h(a,b){var c={x:Math.min(a.x,b.x),y:Math.min(a.y,b.y)},d={x:Math.max(a.x,b.x),y:Math.max(a.y,b.y)};i.x=c.x,i.y=c.y,i.width=d.x-c.x,i.height=d.y-c.y,k.updateOverlay(j,i)}var i,j,k=(a.osd,a.viewer),l=null,m=!1;return osdRegionRectTool={enterEditMode:b,exitEditMode:e},osdRegionRectTool};